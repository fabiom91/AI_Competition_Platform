# What is INFANT - AI Competition Platform

<p >Is a <strong>social network</strong> and a <strong>machine learning competitions platform</strong> dedicated to clinicians and researchers in the field of Paediatrics and Neonatology. INFANT - AI Competition Platform is been made by <a href="https://www.infantcentre.ie/">INFANT Research Centre</a> in the boader <em>Open Science</em> objective.</p>

# Disclaimer:
> This repository has been made out of a MVP product. We cannot guarantee its correct working as it depends on the developer to adapt the code to meet the requirement of he/her own infrastructure.

---

# Usage
This is a web application that is meant to be deployed on a remote server. However, thanks to recent updates, this application can also be installed and run easily on a local machine thanks to `Docker`.

## Local Install
You can download the application by cloning this repo in your local machine:

1. Open a new terminal window on your computer
2. type: `cd ` (with a space) then drag and drop on the terminal window, the folder where you wanna save the repo (e.g. `cd Desktop/myfolder`)
3. then clone this repo by typing: `git clone https://github.com/fabiom91/AI_Competition_Platform.git` and of course press enter. If you're having problem with this command, maybe you get an error that says something like `git command not found`, then you might have to install git: https://git-scm.com/book/en/v2/Getting-Started-Installing-Git
4. Once you have download the repo, in the same terminal window type `cd AI_Competition_Platform` to move to the code folder.
5. Then run `docker-compose build && docker-compose up -d`. If you get an error, you might not have `Docker` installed on your computer: https://www.docker.com/get-started .
   > NOTE: this won't work unless you link your own database to the Platform code. Although Firebase has been used for this application, you can modify it to use any other database.
6. Once that's done, open your browser and visit the following address: `127.0.0.0`. Congratulation! You're live!

---

# Web App Structure
This is a Flask Web application running in a dockerised container. The backend also include a Firebase app and make use of Firebase Storage, Authentication and Firestore database. The frontend is designed with web stack tech such as HTML5, CSS3 and JS with the addition of Bootstrap framework, AJAX and JQuery. The app is currently deployed at: https://infantresearchcommunity.ucc.ie

## Deployment files

- ```main.ini``` : contains all uWSGI configuration code. This file gives uWSGI instruction on how long to wait for a request, how many process allow simultaneously etc. It also instruct the app to save all backend logs in ```/var/log/uwsgi/main.log```

- ```wsgi.py``` : while *main.ini* contains the uWSGI configuration code, *wsgi.py* is the initializer for uWSGI to start serving the app.

## Git files

- ```.gitignore``` : contains all the files that will be ignored by the git repository. This is useful to know when deleting the app or force pulling on the server. All files in listed in this folder are not backed-up anywhere.

## Backend files

- ```main.py``` : is the core of the Flask app. It contains instructions on how to serve a page to the frontend and handling to all possible requests from the frontend. However all Firebase interactions are handled on a separate file that is imported by *main.py* : ```services/myFirebase.py```

- ```services/myFirebase.py``` : contains all the functions to handle the interactions with the Firebase app: Firebase Authentication, Storage and Firestore Database.

- ```firebase_private_key/``` : this folder contain a single **.json** file generated by Firebase that identify the Firebase app and grant access to it to the Flask application where it is called.

## Frontend files

All Frontend HTML files can be found in the **templates** folder. JS, CSS and images can instead be found in the **static** folder, respectively in **js, styles** and **imgs** subfolders.

The frontend web app contains 2 elements: a upper navigation bar and a frame in which all other pages are dynamically loaded via JS and JQuery.

This allow the main page (**main.html** and **main.js**) to be loaded at all time serving the other pages as a frame. The main page is in charge of user login and registration and continuously check wether the user authentication status has changed.

- **Dashboard** : Display all the articles and competitions approved, sorted by date as cards containing the article/competition preview. It uses **pandoc** to convert markdown articles into html.

- **Create_article** : Contain a markdown editor ( see *bower_components* in <i><u>Other files</u></i> section of this document ) that allow the user to write a markdown article even without any markdown previous knowledge. It also contains a for to upload eventual attachments and a popup to make a competition, triggered by the **Make Competition** button.

- **About** : Contain all the FAQs regarding the usage of the platform. Also an extensive description of some of the most important FAQs can be found in specific articles.

- **Profile_view** : Is the profile page which is dynamically populated with the public info of a user when open. It also serves as the landing page after a user registration to complete the mandatory fields (First and Last Name) before being able to interact with the platform as logged user.

- **Read_article** : It display the article selected for reading. It calls specific functions on the backend to retrieve the markdown article and translate it into html (using *pandoc*). From this page, if the article host a competition, the user can also **Join a competition** and **Submit its results**.

- **Admin** : Provide a simple interface for admin and moderators to see all articles written (including pending articles) and all users registered. Clicking on a user or article, open the same and the admin/moderator will be able to use its privileges to:

  - approve an article
  - delete an article (unless competition with 1 or more submissions)
  - edit an article
  - edit or cancel a comment to an article
  - ban users
  - unban users
  - make a user, moderator.

  Full Admin tools are available from the **Firebase Console**

## Other files
As you may have noticed from the repo, there are other files that we haven't discussed yet. Those are:

- ```search_archive/archive.csv``` : Is a csv file that is populated every time a new article or user is created or modified and when the server starts. It holds some basic info regarding users, articles and competitions to be feed to the search_bar available in the dashbord (in the frontend).
- ```static/bower_components/...``` : Those files are needed to serve a markdown editor and interpreter from third-party: https://github.com/kartik-v/krajee-markdown-editor
- ```temp/...``` : Is a temporary folder used to store local files on the server prior to be uploaded to the Firebase storage. In this way, the user does not have to wait until the final upload to Firebase is complete because this happen in the background. Also the file is delete from the folder as soon as the upload to Firebase is successful.

In addition to the above, you may have noticed the folder: ```comp_folder``` on the server app. This folder contains all the files relative to the competitions when they are created.

If you want to delete a competition, first delete the article the host it from the database and from the Firebase Storage (Use the Firebase Console). Then you can safely remove the correspondent competition folder.

# Server logs
The main server log (the uWSGI one) that contains all backend activity on the server is stored here: ```/var/log/uwsgi/main.log```. This file also contains all the errors that happen on the backend so it is one of the primary instruments for debug.

The Logs are also redirect to the container main log and available by running ```docker logs --follow <CONTAINER-NAME OR ID>```
